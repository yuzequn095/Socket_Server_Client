import javax.swing.*;
import java.awt.FlowLayout;
import java.io.*;
import java.net.Socket;

public class ChatClient {

	static JFrame chatWindow = new JFrame("Chat Application");
	static JTextArea chatArea = new JTextArea(22, 40);
	static JTextField textField = new JTextField(35);
	static JLabel blankLabel = new JLabel("           ");//between chat area and text field
	static JButton sendButton = new JButton("Send");
	
	static BufferedReader in;
	static PrintWriter out;
	
	//constructor
	ChatClient(){
		
		chatWindow.setLayout(new FlowLayout());
		chatWindow.add(new JScrollPane(chatArea));
		chatWindow.add(blankLabel);
		chatWindow.add(textField);
		chatWindow.add(sendButton);
		
		chatWindow.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);//close button
		chatWindow.setSize(475, 500);
		chatWindow.setVisible(true);//display
		textField.setEditable(false);//can't enter anything before established
		chatArea.setEditable(false);
	}
	
	void startChat() throws Exception{
		String ipAddress = JOptionPane.showInputDialog(//display dialog box
					chatWindow,
					"Enter IP Address:",
					"IP Address Required!!",
					JOptionPane.PLAIN_MESSAGE);
		
		Socket soc = new Socket(ipAddress, 9806);
		in = new BufferedReader(new InputStreamReader(soc.getInputStream()));
		out = new PrintWriter(soc.getOutputStream(), true);
		
		while(true){//read the data what we get
			String str = in.readLine();
			
			if(str.equals("NAME REQUIRED")){
				String name = JOptionPane.showInputDialog(
							chatWindow,
							"Enter a unique name:",
							"Name Required!!",
							JOptionPane.PLAIN_MESSAGE
						);
				out.println(name);
			}//if ends
			
			else if(str.equals("NAME ALREADY EXISTS")){
				String name = JOptionPane.showInputDialog(
							chatWindow,
							"Enter another name:",
							"Name Already Exist!!",
							JOptionPane.WARNING_MESSAGE
						);
				out.println(name);
			}//else if ends
			
			else if(str.equals("NAME ACCEPTED")){
				textField.setEditable(true);
			}//else if ends
		}
				
	}
	
	public static void main(String[] args) throws Exception{
		ChatClient client = new ChatClient();
		client.startChat();
	}
	
}
